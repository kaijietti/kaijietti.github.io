"use strict";function _typeof3(e){return(_typeof3="function"==typeof Symbol&&"symbol"===_typeof3(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof3(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof3(e)})(e)}var nativeOpen,tape=require("tape"),abortRequest=require("../../lib/abort-request.js"),sendRequest=require("../../lib/send-request.js");"responseURL"in XMLHttpRequest.prototype||(nativeOpen=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(e,t){return this.responseURL=t,nativeOpen.apply(this,arguments)}),tape("test aborting xhr request",function(e){var n=sendRequest.bind({options:{cacheBust:!0}});e.test("- pending request is aborted",function(e){var t=n("https://httpbin.org/delay/10",{},function(){e.fail("xhr was not aborted")});e.equal(t.readyState,1,"xhr readyState is '1' (SENT)"),abortRequest(t),e.equal(t.readyState,0,"xhr readyState is '0' (ABORTED)"),e.equal(t.status,0,"xhr HTTP status is '0' (ABORTED)"),e.equal(t.responseText,"","xhr response is empty"),e.end()}),e.test("- request is not aborted if it has already completed",function(e){var t=n("https://httpbin.org/get",{},function(){abortRequest(t),e.equal(t.readyState,4,"xhr readyState is '4' (DONE)"),e.equal(t.status,200,"xhr HTTP status is '200' (OK)"),e.end()})}),e.test("- request is not aborted if it is undefined",function(t){var e;try{abortRequest(e)}catch(e){t.fail("aborting an undefined request threw an error")}t.equal("undefined","undefined","undefined xhr was ignored"),t.end()}),e.end()});