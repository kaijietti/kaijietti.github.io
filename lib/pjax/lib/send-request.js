"use strict";var updateQueryString=require("./util/update-query-string");module.exports=function(t,u,n){var e,s=(u=u||{}).requestOptions||{},r=(s.requestMethod||"GET").toUpperCase(),a=s.requestParams||null,o=s.formData||null,i=null,l=new XMLHttpRequest,c=u.timeout||0;if(l.onreadystatechange=function(){4===l.readyState&&(200===l.status?n(l.responseText,l,t,u):0!==l.status&&n(null,l,t,u))},l.onerror=function(e){console.log(e),n(null,l,t,u)},l.ontimeout=function(){n(null,l,t,u)},a&&a.length)switch(e=a.map(function(e){return e.name+"="+e.value}).join("&"),r){case"GET":t=t.split("?")[0],t+="?"+e;break;case"POST":i=e}else o&&(i=o);return u.cacheBust&&(t=updateQueryString(t,"t",Date.now())),l.open(r,t,!0),l.timeout=c,l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.setRequestHeader("X-PJAX","true"),l.setRequestHeader("X-PJAX-Selectors",JSON.stringify(u.selectors)),i&&"POST"===r&&!o&&l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.send(i),l};