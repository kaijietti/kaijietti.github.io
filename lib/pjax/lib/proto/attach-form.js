"use strict";var on=require("../events/on"),clone=require("../util/clone"),attrState="data-pjax-state",formAction=function(t,e){var r,o,a;isDefaultPrevented(e)||((r=clone(this.options)).requestOptions={requestUrl:t.getAttribute("action")||window.location.href,requestMethod:t.getAttribute("method")||"GET"},(o=document.createElement("a")).setAttribute("href",r.requestOptions.requestUrl),(a=checkIfShouldAbort(o,r))?t.setAttribute(attrState,a):(e.preventDefault(),"multipart/form-data"===t.enctype?r.requestOptions.formData=new FormData(t):r.requestOptions.requestParams=parseFormElements(t),t.setAttribute(attrState,"submit"),r.triggerElement=t,this.loadUrl(o.href,r)))};function parseFormElements(t){for(var e=[],r=t.elements,o=0;o<r.length;o++){var a=r[o],n=a.tagName.toLowerCase();if(a.name&&void 0!==a.attributes&&"button"!==n){var i=a.attributes.type;if(!i||"checkbox"!==i.value&&"radio"!==i.value||a.checked){var l=[];if("select"===n)for(var s,u=0;u<a.options.length;u++)(s=a.options[u]).selected&&!s.disabled&&l.push(s.hasAttribute("value")?s.value:s.text);else l.push(a.value);for(var c=0;c<l.length;c++)e.push({name:encodeURIComponent(a.name),value:encodeURIComponent(l[c])})}}}return e}function checkIfShouldAbort(t,e){return t.protocol!==window.location.protocol||t.host!==window.location.host?"external":t.hash&&t.href.replace(t.hash,"")===window.location.href.replace(location.hash,"")?"anchor":t.href===window.location.href.split("#")[0]+"#"?"anchor-empty":e.currentUrlFullReload&&t.href===window.location.href.split("#")[0]?"reload":void 0}var isDefaultPrevented=function(t){return t.defaultPrevented||!1===t.returnValue};module.exports=function(e){var r=this;e.setAttribute(attrState,""),on(e,"submit",function(t){formAction.call(r,e,t)})};